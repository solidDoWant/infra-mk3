---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: node-network-operator
spec:
  interval: 5m
  chart:
    spec:
      chart: node-network-operator
      reconcileStrategy: ChartVersion
      sourceRef:
        kind: HelmRepository
        namespace: flux-system
        name: soliddowant-charts
      version: 0.0.3
  values:
    config:
      crds:
        # These are installed via a separate Kustomization
        enabled: false
      webhook:
        enableTLS: true
        issuerRef:
          kind: Issuer
          name: networking-intermediary-ca
    resources:
      rawResources:
        webhook-certificate:
          spec:
            spec:
              commonName: Node Network Operator
              subject:
                countries:
                  - US
                provinces:
                  - ${SECRET_STATE}
                organizations:
                  - infra-mk3
              usages:
                - server auth
              duration: 4h
