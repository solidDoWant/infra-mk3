---
# yaml-language-server: $schema=https://raw.githubusercontent.com/datreeio/CRDs-catalog/refs/heads/main/kubevirt.io/kubevirt_v1.json
apiVersion: kubevirt.io/v1
kind: KubeVirt
metadata:
  name: kubevirt
spec:
  configuration:
    developerConfiguration:
      featureGates:
        - EnableVirtioFsConfigVolumes
        - EnableVirtioFsStorageVolumes
    evictionStrategy: LiveMigrate
    migrations:
      allowAutoConverge: true
      allowWorkloadDisruption: false
    network:
      # Needed for live migration to work properly
      defaultNetworkInterface: masquerade
      permitBridgeInterfaceOnPodNetwork: false
    # Roll out changes right away via migrations where supported
    vmRolloutStrategy: LiveUpdate
    vmStateStorageClass: ssd-replicated-3d
  monitorNamespace: monitoring
  monitorAccount: vmagent-victoria-metrics-k8s-stack
  serviceMonitorNamespace: system-controllers
